{% extends 'base.html' %}
{% load static %}
{% block content %}

<!doctype html>
<html lang="en"> 

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Edit Data{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <style>
        * {
            font-family: Georgia;
        }

        .container1 {
            margin-top: 60px
        }

        .input-demo{
            width: 80% !important;
        }
        .page-content {
        background-color: lightcyan;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
        max-width: 950px;
        /* Adjust the max-width as needed */
        margin-top: -3px;
        /* Center the container horizontally */
    }
    </style>
</head>

<body>
    <!-- kkkkkkkkkkkkkkkkkkkkk -->

    <div class="container-fluid container1">
       
        <div class="page-wrapper">
            <div class="page-content">
                <div class="breadcrumb-title pe-3">Update Data</div>
                <hr>
                <form method="POST" onsubmit="return myfun()">
                    {% csrf_token %}
                    

                    <!-- date -->
                    <div class="row">
                        <div class="col-md-9" style="margin-right: 60px;"></div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <div class="input-group">
                                    <input type="date" class="form-control mobile" name="form_date" id="date"
                                        placeholder="{% now 'Y-m-d' %}" value="{% now 'd-m-Y' %}" required max="{% now 'Y-m-d' %}" readonly/>
                                </div>
                            </div>
                        </div>
                    </div>

    

                    <!-- vender name address mob no -->
                    <div>
                        
                            <div class="row ">
                                <div class="d-grid gap-1 col-sm-6">
                                    <div class="mb-3">
                                    <label for="name" class="control-label" disabled><b>Vender Name<span
                                                style="color:red;">*</span></b></label>
                                    <input class="form-control" name="form_vender" value="{{data.form_vender}}"
                                        readonly>
                                </div>
                             </div>
                             <div class="d-grid gap-1 col-sm-6">
                                <div class="mb-3">
                                    <label>Code<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form_code" value="{{data.form_code}}" readonly>
                                </div>
                             </div>
                             <div class="d-grid gap-1 col-sm-6">
                                <div class="mb-3">
                                    <label>Brand<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form_brand" value="{{data.form_brand}}" readonly>
                                 </div>
                             </div>
                             <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                    <label>Class<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form_class" value="{{data.form_class}} "readonly>
                                </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                  <label>Medium<span style="color:red;">*</span></label>
                                   <input class="form-control " name="form_medium" value="{{data.form_medium}}"readonly >
                                </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                    <label>Subject<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form_subject" value="{{data.form_subject}}" readonly>

                                </div>
                             </div>
                             <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                    <label>Pages<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form_pages" value="{{data.form_pages}}" readonly>
                                </div>
                             </div>
                             <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                    <label>Received Form1<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form1" value="{{data.form1}}" >
                                </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                <div class="form-group">
                                    <label>Received Form2<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form2" value="{{data.form2}}" >
                                </div>
                            </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                <div class="form-group">
                                    <label>Received Form3<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form3" value="{{data.form3}}" >
                                </div>
                            </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                <div class="form-group">
                                    <label>Received Form4<span style="color:red;">*</span></label>
                                    <input class="form-control " name= "form4"value="{{data.form4}}" >
                                </div>
                            </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                <div class="form-group">
                                    <label>Received form5<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form5" value="{{data.form5}}" >
                                </div>
                            </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                <div class="form-group">
                                    <label>Received Form6<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form6" value="{{data.form6}}" >
                                </div>
                            </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                <div class="form-group">
                                    <label>Received Form7<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form7" value="{{data.form7}}" >
                                </div>
                            </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                <div class="form-group">
                                    <label>Received Form8<span style="color:red;">*</span></label>
                                    <input class="form-control " name= "form8"value="{{data.form8}}" >
                                </div>
                            </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                <div class="form-group">
                                    <label>Received Form9<span style="color:red;">*</span></label>
                                    <input class="form-control " name="form9" value="{{data.form9}}" >
                                </div>
                            </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                <div class="form-group">
                                    <label>Received form10<span style="color:red;">*</span></label>
                                    <input class="form-control " name= "form10"value="{{data.form10}}" >
                                </div>
                            </div>
                            </div>
                            <div class="d-grid gap-2 col-sm-6">
                                <div class="mb-3">
                                <div class="form-group">
                                    <label>Total Received<span style="color:red;">*</span></label>
                                    <input class="form-control " name= "total_forms"value="{{data.total_forms}}" readonly >
                                </div>
                            </div> 
                            </div>
                        </div> 
                    </div>
                                            
                    <!-- end values -->
                
                            
                    <!-- order 1 -->
                    
                     <!--{% comment %} <button type="submit" name="gather_approved" value="approval_button" class="btn btn-primary" style="background-color:; color:white;">Approve Gathering</button> {% endcomment %}-->
                     <div class="col-12" style="text-align: center;">
                    <button type="submit" class="btn btn-primary" style="background-color:mediumaquamarine ; color:white; text-align: center;">DONE</button>
                </div>
                </form>
            </div>
        </div>
    </div>
    {% comment %} <script>
        function updatePrintingReceivedForms() {
            const pagesValue = parseInt(document.querySelector('[name="p_pages_1"]').value);
            const totalGatherValue = parseInt(document.querySelector('[name="total_received_forms"]').value);
            const printingReceivedForms = document.querySelectorAll('[name^="p_printing_received_form_"]');
            
            printingReceivedForms.forEach((input, index) => {
                const requiredBoxes = Math.ceil(pagesValue / 32);
                
                if (index < requiredBoxes ) {
                    input.closest('.col-md-2').style.display = 'block';
                } else {
                    input.closest('.col-md-2').style.display = 'none';
                }
            });
        }
    
        // Call the function initially and whenever the pages value changes
        updatePrintingReceivedForms();
        document.querySelector('[name="p_pages_1"]').addEventListener('change', updatePrintingReceivedForms);
        document.querySelector('[name="total_received_forms"]').addEventListener('change', updatePrintingReceivedForms);
    </script>
     {% endcomment %}


     {% comment %} <script>
        function updatePrintingReceivedForms() {
            const pagesValue = parseInt(document.querySelector('[name="form_pages"]').value);
            const totalGatherValue = parseInt(document.querySelector('[name="total_forms"]').value);
            const printingReceivedForms = document.querySelectorAll('[name^="form"]');
            
            printingReceivedForms.forEach((input, index) => {
                const requiredBoxes = Math.ceil(pagesValue / 32);
                
                if (index < requiredBoxes ) {
                    input.closest('.col-md-2').style.display = 'block';
                } else {
                    input.closest('.col-md-2').style.display = 'none';
                    input.value = totalGatherValue === 0 ? "0" : "";
                }
            });
            
            // Add your condition here to update data.total_received_forms
            data.total_forms = totalGatherValue;
        }
    
        // Call the function initially and whenever the pages value changes
        updatePrintingReceivedForms();
        document.querySelector('[name="form_pages"]').addEventListener('change', updatePrintingReceivedForms);
        document.querySelector('[name="total_received_forms"]').addEventListener('change', updatePrintingReceivedForms);
    </script>
     {% endcomment %}
     <script>
        function updatePrintingReceivedForms() {
            const pagesValue = parseInt(document.querySelector('[name="form_pages"]').value);
            const totalGatherValue = parseInt(document.querySelector('[name="total_forms"]').value);
            
            for (let i = 1; i <= 10; i++) {
                const formValue = document.querySelector(`[name="form${i}"]`);
                
                if (formValue.value === "0" || formValue.value.toLowerCase() === "none" || formValue.value === "") {
                    formValue.closest('.form-group').style.display = 'none';
                } else {
                    formValue.closest('.form-group').style.display = 'block';
                }
            }
        }
    
        // Call the function initially and whenever the pages or total_forms value changes
        updatePrintingReceivedForms();
        document.querySelector('[name="form_pages"]').addEventListener('input', updatePrintingReceivedForms);
        document.querySelector('[name="total_forms"]').addEventListener('input', updatePrintingReceivedForms);
    </script>
    
    
    
    

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous">
        </script>

    <script>
        $(document).ready(function () {
            var max_fields_limit = 11;
            var x = 1;
            $('.add_more_button').click(function (e) {
                e.preventDefault();
                $('#myDiv').show();
                if (x < max_fields_limit) {
                    x++;
                    $('.input_fields_container').append(

                        '<div class="form-group row" style="padding-left:0px; padding-right:10px;padding-top:20px;"><div class="col-md-2 form-group description"><input type="text" pattern="[a-z A-Z 0-9\s]+" class="form-control mobile" name="brand_name_' + x.toString() + '" id="brand_name_' + x.toString() + '" placeholder="brand name" value="" required maxlength="30" /></div><div class="col-md-2 form-group "><input type="text" class="form-control mobile" name="class_name_' + x.toString() + '" id="class_name_' + x.toString() + '" maxlength="30" placeholder="Class Name" min=""  pattern="^[a-z A-Z 0-9]+$" value="" required /></div><div class="col-md-2 form-group description"><input class="form-control mobile" style="width:110%;"  name="medium_' + x.toString() + '" id="medium_' + x.toString() + '" type="text" maxlength="30" placeholder=" Medium" min=""  pattern="^[a-zA-Z0-9]+$" value="" required /></div><div class="col-md-2 form-group description"><input class="form-control mobile" style="width:110%;" name="subject_' + x.toString() + '" id="subject_' + x.toString() + '" placeholder="Subject" value="" required maxlength="30"></div><div class="col-md-2 form-group quantity"><input type="number" pattern="[0-9\s]+" class="form-control mobile"name="quantity_' + x.toString() + '" id="quantity_' + x.toString() + '" placeholder="Quantity" value="" required maxlength="30"/></div><div class="col-md-2 form-group rate"><input type="number" pattern="[a-zA-Z0-9\s]+" class="form-control mobile"name="rim_' + x.toString() + '" id="rim_' + x.toString() + '" placeholder="Rims" value="" maxlength="30"/></div><a href="#" class="remove_field col-md-12" style="margin-left:10px; text-align:right;">Remove</a></div>'); //add input field
                    // <input type="text" class="form-control mobile" name="amount_'+x.toString()+'" id="amount_'+x.toString()+'" placeholder="Amount" value="" required />
                }
            });
            $('.input_fields_container').on("click", ".remove_field", function (e) { //user click on remove text links
                e.preventDefault(); $(this).parent('div').remove(); x--;

            })
        });
        function restrictMinus(e) {
            var inputKeyCode = e.keyCode ? e.keyCode : e.which;
            if (inputKeyCode != null) {
                if (inputKeyCode == 45) e.preventDefault();
            }
        }
    </script>

    <script>
        // Get the modal
        var modal = document.getElementById("myModal");

        // Get the button that opens the modal 
        var btn = document.getElementById("myBtn");

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];

        // When the user clicks the button, open the modal 
        btn.onclick = function () {
            modal.style.display = "block";
        }

        // When the user clicks on <span> (x), close the modal
        span.onclick = function () {
            modal.style.display = "none";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
    </script>

    <script>
        document.getElementById("from_date").onchange = function () {
            var input = document.getElementById("to_date");
            input.setAttribute("min", this.value);
        }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/7.29.2/sweetalert2.all.js"></script>

    <script type="text/javascript">
        var rad = document.cash_memo_add.stamp_type;
        var prev = null;
        for (var i = 0; i < rad.length; i++) {
            rad[i].addEventListener('change', function () {
                (prev) ? console.log(prev.value) : null;
                if (this !== prev) {
                    prev = this;
                }
                if (this.value == 'merchant_stamp') {
                    document.getElementById('default_stmaps').style.display = 'block';
                    document.getElementById('own_stamps').style.display = 'none';
                }
                else if (this.value == 'own_stamp') {
                    // document.getElementById('messageError').innerHTML = "";
                    document.getElementById('default_stmaps').style.display = 'none';
                    document.getElementById('own_stamps').style.display = 'block';
                }
            });
        }
    </script>

    <script type="text/javascript">
        jQuery.validator.addMethod("greaterStart", function (value, element, params) {
            return this.optional(element) || new Date(value) >= new Date($(params).val());
        }, 'Must be greater than from date.');

        $("#add_merchant_form").validate({
            rules: {
                chk: {
                    required: true,
                },
            },

        });
        $("#stamp_image_form").validate({
            rules: {
                chkcashmeo: {
                    required: true,
                },
            },

        });
        $("#bill_info_filter_form").validate({
            rules: {
                from_date: {
                    required: true,
                },
                to_date: {
                    required: true,
                    greaterStart: "#from_date",
                },
            },

        });
        $(document).ready(function () {
            // $('input[name=to_date]').change(function() {
            //         var to_date = $('#to_date').val();
            //         document.getElementById('from_date').setAttribute("max", to_date);
            // })

            // $('input[name=from_date]').change(function() {
            //   var from_date = $('#from_date').val();
            //     document.getElementById('to_date').setAttribute("min", from_date);
            // })
        })
    </script>

    <script>
        $(document).ready(function () {
            $('#add-row').DataTable({
                dom: 'lBfrtip',
                "ordering": false,
                "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                buttons: [
                    'excel', 'pdf', 'print'
                ],
                initComplete: function () {
                    this.api().columns([2, 3]).every(function () {
                        var column = this;
                        var select = $('<select multiple="multiple" id="column_id_' + column[0][0] + '"><option value=""></option></select>')

                            .appendTo($("#type_filter_" + column[0][0]).empty())

                            .on('change', function () {

                                var val = $(':selected', select).map(function (index, element) {
                                    return $.fn.dataTable.util.escapeRegex($(this).val());
                                }).toArray().join('|');

                                column
                                    .search(val ? '^' + val + '$' : '', true, false)
                                    .draw();
                            });

                        column.data().unique().sort().each(function (d, j) {
                            select.append('<option value="' + d + '">' + d + '</option>')
                        });
                    });
                }
            });

            $("#column_id_2").select2({
                placeholder: " Select Date",
                closeOnSelect: true,
                width: '90%',
            })

            $("#column_id_3").select2({
                placeholder: " Select Number",
                closeOnSelect: true,
                width: '80%',
            })

        });
    </script>

    <script>
        var today = new Date();

        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!
        var yyyy = today.getFullYear();

        if (dd < 10) {
            dd = '0' + dd
        }

        if (mm < 10) {
            mm = '0' + mm
        }

        // today = yyyy + '/' + mm + '/' + dd;
        today = yyyy + '-' + mm + '-' + dd;

        console.log(today);
        document.getElementById('date').value = today;
    </script>

    <script type="text/javascript">
        $(document).ready(function () {

            $("#id_venderlist").on('change', function () {

                var state = $("#id_venderlist").val();
                // alert(state);

                $.ajax({
                    type: "POST",
                    url: "/Orderlist/" + state,
                    data: {
                        csrfmiddlewaretoken: document.getElementsByName('csrfmiddlewaretoken')[0].value,
                        'organization_name': state
                    },
                    success: function (result) {

                        $("#id_courselist").empty();
                        var empty = ""
                        $('#id_courselist').append("<option value='" + empty + "' disabled selected value>" + "Select Address *" + "</option>");
                        $.each(result.data, function (key, value) {
                            $('#id_courselist').append("<option value='" + value + "'>" + value + "</option>");
                        });
                    }
                });

            })
        })
    </script>

    <script type="text/javascript">
        $(document).ready(function () {

            $("#id_courselist").on('change', function () {

                var state = $("#id_courselist").val();
                // alert(state);

                $.ajax({
                    type: "POST",
                    url: "/Addresslist/" + maha,
                    data: {
                        csrfmiddlewaretoken: document.getElementsByName('csrfmiddlewaretoken')[0].value,
                        'medium': maha
                    },
                    success: function (result) {

                        $("#id_offervalue").empty();
                        var empty = ""
                        $('#id_offervalue').append("<option value='" + empty + "' disabled selected value>" + "Select special offer*" + "</option>");
                        $.each(result.data, function (key, value) {
                            $('#id_offervalue').append("<option value='" + value + "'>" + value + "</option>");
                        });
                    }
                });

            })
        })
    </script>

    <script type="text/javascript">
        $(document).ready(function () {

            $("#id_brand").on('change', function () {

                var state = $("#id_brand").val();
                // alert(state);

                $.ajax({
                    type: "POST",
                    url: "/Brandlist/" + city,
                    data: {
                        csrfmiddlewaretoken: document.getElementsByName('csrfmiddlewaretoken')[0].value,
                        'books_name': city
                    },
                    success: function (result) {

                        $("#id_classname").empty();
                        var empty = ""
                        $('#id_classname').append("<option value='" + empty + "' disabled selected value>" + "Select classname *" + "</option>");
                        $.each(result.data, function (key, value) {
                            $('#id_classname').append("<option value='" + value + "'>" + value + "</option>");
                        });
                    }
                });

            })
        })
    </script>

    <script>
        const pagesInput = document.getElementById('pages_1');
        const quantityInput = document.getElementById('quantity_1');
        const brandSelect = document.getElementById('brand_name_1');
        const formsPerSetInput = document.getElementById('forms-per-set');
        function calculateFormsPerSet() {
            const pages = parseInt(pagesInput.value);
            const quantity = parseInt(quantityInput.value);
            const brand = brandSelect.value;
            let pagesPerForm = 0;
            if (brand === 'Kohinoor') {
                pagesPerForm = 64;
            } else if (brand === 'Spark') {
                pagesPerForm = 128;
            } else if (brand === 'Vidhya Mitra') {
                pagesPerForm = 32;
            } else if (brand === 'Abhiyashika') {
                pagesPerForm = 16;
            }
            const forms = Math.ceil(pages / pagesPerForm * quantity);
            const totalSet = Math.ceil(pages / 32);
            const formsPerSet = Math.ceil(forms / totalSet);
            formsPerSetInput.value = formsPerSet;
        }

        pagesInput.addEventListener('input', calculateFormsPerSet);
        quantityInput.addEventListener('input', calculateFormsPerSet);
        brandSelect.addEventListener('change', calculateFormsPerSet);
    </script>



    
</body>

</html>

{% endblock %}